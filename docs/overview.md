# Hydro-Evaluation System (HES)

## Introduction
There are many different types of users who need to evaluate hydrologic models and the forecasts generated by those models. The users range from researchers to operations to after-action evaluations. 

The envisioned hydro-evaluation system (HES) will consist of a core system that can be utilized directly or can be extended to meet specific use cases not covered by the core system.

## Use Cases
For development design and planning two primary use cases were identified.  These are expected to be representative of many uses cases but will not completely cover other uses cases.  Therefore, modularity, flexibility and extendability will be key design concepts.

* CIROH researcher (See @kvanwerkhoven Power Point)
    * As a CIROH researcher I want to...

* ISED after action evaluation (See @kvanwerkhoven Power Point)
    * As a member of ISED I want to...

## Existing Systems
There are several existing systems that provide some of the envisioned functionality.  The extent to which these systems overlap with what is envision for this project is unknown and needs to be researched.

* Water Resources Evaluation System (WRES)/Water Resources Data System (WRDS) - [Not 100% sure I got these names correct] An existing OWP evaluation system.  WRDS provides NWM data.  WRES allows a user to setup an evaluation and execute it.
* ILAMB

## Vision
A core evaluation system that can be customized and utilized to meet the needs of a wide range of users.

* For a CIROH researcher wanting to compare one or more models to each other or some baseline model run, the HES could be stood-up and run in some relatively "default" mode that would, given all the correct inputs and configurations, generate a standard output report that could be used to answer the question, "is the model formulation B better than model formulation A", for example.  As long as the system was running the user would also be able to explore the datasets that went into the evaluation and "slice and dice" them to better understand them.

* For ISED, the system could be stood-up and configured to automatically ingest and process some amount of data to be ready to use when an event happens and an after-action evaluation is needed.

While these use cases are not the same, the premise is, from a technology perspective, there may be core components that are the same between the two use cases.  This is a good place to focus, to begin with.

## Concept
Data will be stored as close to raw as practical and use the power of SQL to build materialized views and query out the required information.

See DB schema.
## Components
At the heart of the evaluation system is timeseries - therefore, a fast efficient timeseries database will be the heart of the evaluation system.  
Other components:

* Data loading library
* Data storage system (the "heart")
    * Timeseries
    * Geographic data
    * Grided data?
    * Static datasets (gage location, HUC basins, etc.)
    * Cross walk tables
* Data access library
* Analysis library
* Web API
* Web UI

### Data loading library
* Code library that provides the necessary tools to load data into the HES for many different sources and in many different formats.  For example:
    * A central data service such as something similar to WRDS for NWM data (this could be what James H. et. al. are building)
    * NWIS for USGS gage data
    * AHPS forecasts
    * Flat files (e.g., CSV file generated by a researcher)
    * NetCDF files (current publicly available NWM data)
    * HDF5
    * Shapefiles
    * Gridded data (numerous formats)
* Configurations (study definitions, recipes, etc.)
* Library should support automated, scheduled or on demand runs as required per use case.

### Data storage
* Timeseries (focus here)
* Geographic data (raster and vector)
* Tags (Thresholds
* Study configuration/definition
* Static data (USGS gage locations, NHD catchments, etc.)
* Hydrofabric data?

### Analysis
To steal the WRDS terminology:
* Pair
* Pool
* Statistics

### Access
Multiple levels of access ranging from raw SQL to a Python library (e.g., with Pandas) to a web service.
* SQL
* Python
* Web API
* Web application

## Infrastructure
100% containerized
